== Unlocking Application Secrets: Introducing Hardware-Backed Key Derivation with WebAuthn PRF and the YubiKey
:author: Yubico Developer Program
:revdate: 2025-06-25
:description: Discover how the WebAuthn PRF extension allows you to derive strong, hardware-backed symmetric keys from a YubiKey, enabling a new generation of phishing-resistant, end-to-end encrypted applications.
:keywords: WebAuthn, PRF, CTAP, hmac-secret, FIDO2, YubiKey, Encryption, Passkeys, Security
:page-image: /assets/images/blog/webauthn-prf-social.png
:page-nav_title: Unlocking Application Secrets with PRF

Developers face a fundamental challenge: how do you secure user data that needs to be encrypted on the client? Storing encryption keys on a server creates a massive target for attackers. Deriving keys from user passwords makes them vulnerable to phishing and offline cracking.

This is where the FIDO2 and WebAuthn standards evolve beyond simple authentication. Today, we're exploring one of their most transformative extensions: the **Pseudo-Random Function (PRF)**. This extension allows your application to ask a YubiKey to derive a unique secret that can be used for symmetric key cryptography, all without the root keying material ever leaving the hardware.

Imagine building a password manager where the user's vault is unlocked with a single tap of their YubiKey, no master password required. Or consider a non-custodial digital identity wallet like **wwWallet**, where a user's sensitive credentials are encrypted in the cloud using a key that only their personal passkey can derive. The service provider can't see the data, providing perfect forward secrecy and user sovereignty.

This is the new paradigm PRF enables: stateless, phishing-resistant, and anchored in hardware security.

=== What is WebAuthn PRF?

At a high level, the WebAuthn PRF extension (`prf`) is a mechanism that allows a Relying Party (your web application) to request a 32-byte secret from a user's FIDO2 authenticator during an authentication ceremony.

Think of it as a secure, one-way calculator built into every modern YubiKey. Your application provides an input (**salt**), and the YubiKey uses its own unique, credential-specific internal key to compute a pseudo-random output (**secret**).

[source,text]
----
[YubiKey's Internal Credential Key + Your Salt] -> HMAC-SHA-256 -> [32-byte Derived Secret]
----

The critical security guarantee is that the YubiKey's internal key—the root of this entire operation—**never leaves the secure element**. The derived secret is computed on-demand and passed to the browser, but the foundation of that secret remains securely stored in hardware.

=== Why PRF is a Game-Changer for Developers

This capability unlocks architectural patterns that were previously complex or insecure.

* **Truly End-to-End Encrypted Applications:** Build web apps where user data (documents, messages, notes) is encrypted in the browser before being sent to your cloud storage. Your server only ever holds encrypted blobs of data. The key to decrypt that data is derived from the user's YubiKey each time they log in.
* **Phishing-Resistant Vaults & Password Managers:** Create applications where the master key to unlock a user's vault of secrets is derived directly from their YubiKey. This completely eliminates the threat of a phishing attack stealing a master password.

While the most visible application of PRF is through the WebAuthn browser API, its power is not limited to the web. The underlying `hmac-secret` technology can be accessed directly in your native mobile and desktop applications using Yubico's comprehensive suite of SDKs, allowing you to build secure, hardware-backed key derivation into any platform.

=== The Yubico Advantage: Security at the Root

While the WebAuthn standard defines the `prf` extension, the strength of the derived secret depends entirely on the security of the authenticator. With a YubiKey, you are leveraging decades of hardware security engineering. The derived secret is rooted in a credential protected by the YubiKey's tamper-resistant secure element, providing the highest level of assurance that the key cannot be cloned, extracted, or tampered with.

This is the future of application security: stateless, phishing-resistant, and anchored in hardware.

Ready to see how it's done? In the next part of this series, we'll dive into the code for both web and native applications.

link:./developers-guide-to-prf.adoc[Read Part 2: A Developer's Guide to Deriving Keys with WebAuthn PRF and YubiKeys]
