<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Securing SSH Authentication with FIDO2 Security Keys</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_securing_ssh_authentication_with_fido2_security_keys">Securing SSH Authentication with FIDO2 Security Keys</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction">.1. Introduction: The Power of FIDO2 for SSH</h3>
<div class="paragraph">
<p>Secure Shell (SSH) is a cornerstone of secure remote access and operations for developers. Traditionally, SSH relies on public-key cryptography, where private keys are stored as files on your computer. While secure, these files can be targets for theft or unauthorized access.</p>
</div>
<div class="paragraph">
<p>FIDO2 security keys, such as the YubiKey, revolutionize SSH security by ensuring your <strong>private SSH keys never leave the hardware security key</strong>. This provides robust protection against malware, phishing, and remote attacks targeting your SSH credentials. Furthermore, FIDO2 mandates <strong>physical presence (a touch to your YubiKey) for cryptographic operations</strong>, adding a critical layer of security that prevents unauthorized use even if your workstation is compromised.</p>
</div>
<div class="paragraph">
<p>This guide details how to generate and use SSH keys directly on your FIDO2 security key, leveraging the capabilities built into OpenSSH. We&#8217;ll cover key generation, platform-specific setup, integration with services like GitHub, and important security best practices.</p>
</div>
</div>
<div class="sect2">
<h3 id="prerequisites">.2. Prerequisites</h3>
<div class="paragraph">
<p>Before you begin, ensure you have the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A FIDO2 Security Key:</strong> Any YubiKey with FIDO2 support (YubiKey 5 Series, YubiKey Bio Series, Security Key Series by Yubico).</p>
</li>
<li>
<p><strong>OpenSSH Client:</strong></p>
<div class="ulist">
<ul>
<li>
<p>OpenSSH version <strong>8.2 or newer</strong> is required for basic FIDO2 hardware-backed key support.</p>
</li>
<li>
<p>OpenSSH version <strong>8.3 or newer</strong> is recommended for the <code>verify-required</code> option, which mandates user verification (touch) for each use.</p>
</li>
<li>
<p>OpenSSH version <strong>8.9 or newer</strong> is recommended for the <code>credProtect</code> extension (for non-resident keys that require user verification).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>YubiKey Manager:</strong> While not strictly required for all SSH operations once keys are generated, YubiKey Manager is essential for setting or changing your FIDO2 PIN on the YubiKey, which is highly recommended for resident keys. Download it from the <a href="https://www.yubico.com/products/yubikey-manager/">Yubico website</a>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="platform-specific-openssh">.2.1. Platform-Specific OpenSSH Setup</h4>
<div class="paragraph">
<p>Ensure your OpenSSH client meets the version requirements. Here&#8217;s how to check and update on common platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Check your version:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ssh -V</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Linux:</strong></p>
<div class="paragraph">
<p>Most modern Linux distributions include a sufficiently recent OpenSSH client. If not, update via your package manager:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># For Debian/Ubuntu
sudo apt update &amp;&amp; sudo apt install openssh-client

# For Fedora/RHEL/CentOS
sudo dnf check-update &amp;&amp; sudo dnf install openssh-clients</code></pre>
</div>
</div>
</li>
<li>
<p><strong>macOS:</strong></p>
<div class="paragraph">
<p>The OpenSSH version bundled with macOS may be outdated. It&#8217;s <strong>strongly recommended</strong> to install the latest version using Homebrew:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">brew install openssh</code></pre>
</div>
</div>
<div class="paragraph">
<p>After installation, ensure your <code>PATH</code> prioritizes the Homebrew version (e.g., by adding <code>/usr/local/bin</code> or <code>/opt/homebrew/bin</code> for Apple Silicon to the beginning of your <code>PATH</code>). You may need to restart your terminal or source your shell profile.</p>
</div>
</li>
<li>
<p><strong>Windows:</strong></p>
<div class="paragraph">
<p>Windows 10 (version 1809 and later) and Windows 11 include an OpenSSH client. Ensure it&#8217;s installed and up-to-date:
<strong> </strong>Via Optional Features:<strong> Settings &gt; Apps &gt; Optional features &gt; Search for "OpenSSH Client" and install if not present.
</strong> <strong>Via PowerShell (as Administrator):</strong></p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell"># To check if installed
Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Client*'

# To install
Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>+
For FIDO2 features, especially on Windows, using Windows Subsystem for Linux (WSL) 2 with a modern Linux distribution can often provide a more seamless experience if the native Windows OpenSSH client has limitations.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-fido2-pin">.3. Setting or Changing Your FIDO2 PIN (Recommended)</h3>
<div class="paragraph">
<p>For enhanced security, especially with resident keys, set a FIDO2 PIN on your YubiKey using YubiKey Manager:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Insert your YubiKey.</p>
</li>
<li>
<p>Open YubiKey Manager.</p>
</li>
<li>
<p>Navigate to Applications &gt; FIDO2.</p>
</li>
<li>
<p>Click "Set PIN" (or "Change PIN" if one is already set).</p>
</li>
<li>
<p>Follow the prompts. Choose a secure, memorable PIN.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This PIN will be required when generating resident keys and potentially when using them, depending on key generation options.</p>
</div>
</div>
<div class="sect2">
<h3 id="ssh-key-generation">.4. Generating Your FIDO2 SSH Key</h3>
<div class="paragraph">
<p>You can generate two main types of FIDO2-backed SSH keys: <code>ecdsa-sk</code> or <code>ed25519-sk</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ecdsa-sk</code>: Elliptic Curve DSA with FIDO2. Supported on YubiKeys with FIDO2.</p>
</li>
<li>
<p><code>ed25519-sk</code>: EdDSA with FIDO2. More modern, generally preferred for performance and security. Requires YubiKey firmware <strong>5.2.3 or higher</strong>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="generating-ed25519sk">.4.1. Generating an <code>ed25519-sk</code> Key (Recommended)</h4>
<div class="paragraph">
<p>This is the recommended key type if your YubiKey firmware supports it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ssh-keygen -t ed25519-sk -O resident -O verify-required -C "your_email@example.com or a comment"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="generating-ecdsask">.4.2. Generating an <code>ecdsa-sk</code> Key</h4>
<div class="paragraph">
<p>If your YubiKey firmware is older than 5.2.3, or for specific compatibility reasons:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ssh-keygen -t ecdsa-sk -O resident -O verify-required -C "your_email@example.com or a comment"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="keygen-options-explained">.4.3. Key Generation Options Explained:</h4>
<div class="ulist">
<ul>
<li>
<p><code>-t ed25519-sk</code> or <code>-t ecdsa-sk</code>: Specifies the key type.</p>
</li>
<li>
<p><code>-O resident</code> (Highly Recommended):</p>
<div class="ulist">
<ul>
<li>
<p>This option creates a <strong>discoverable credential</strong> (resident key), meaning the private key handle is stored <strong>on the YubiKey itself</strong>.</p>
</li>
<li>
<p><strong>Benefit:</strong> True portability. You can use your YubiKey on different computers without needing to copy any private key files. You&#8217;ll typically regenerate the public key file from the YubiKey on a new machine (see <a href="#using-resident-keys-new-machine">Using Resident Keys on a New Machine</a>).</p>
</li>
<li>
<p>Requires a FIDO2 PIN to be set on the YubiKey beforehand. You will be prompted for your FIDO2 PIN during generation.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>-O verify-required</code> (Highly Recommended, requires OpenSSH 8.3+):</p>
<div class="ulist">
<ul>
<li>
<p>Ensures that every time the SSH key is used, you must physically touch your YubiKey to approve the operation.</p>
</li>
<li>
<p>If a PIN was set during generation of a resident key, it might also be required by the authenticator.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>-O application=ssh:&lt;name&gt;</code> (Optional, for multiple resident keys):</p>
<div class="ulist">
<ul>
<li>
<p>Allows you to specify an application string, useful if you plan to store multiple resident SSH keys on the same YubiKey for different services (e.g., <code>ssh:github_personal</code>, <code>ssh:work_gitlab</code>).</p>
</li>
<li>
<p>Example: <code>ssh-keygen -t ed25519-sk -O resident -O verify-required -O application=ssh:my_github -C "GitHub Key"</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>-C "comment"</code>: A comment to help you identify the key, often an email address or description.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you choose <strong>not</strong> to use <code>-O resident</code>, the private key handle is stored as a file on your computer (e.g., <code>~/.ssh/id_ed25519_sk</code>). For such non-resident keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the <code>-O credProtect</code> option (requires OpenSSH 8.9+) to ensure user verification is still required on the YubiKey for each use:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ssh-keygen -t ed25519-sk -O credProtect -C "Non-resident key comment"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This maintains a high level of security even for non-resident keys.</p>
</div>
</div>
<div class="sect3">
<h4 id="key-generation-process">.4.4. The Key Generation Process</h4>
<div class="paragraph">
<p>When you run <code>ssh-keygen</code> with these options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You&#8217;ll be prompted to touch your YubiKey to confirm presence.</p>
</li>
<li>
<p>If generating a resident key (<code>-O resident</code>), you&#8217;ll be prompted for your FIDO2 PIN.</p>
</li>
<li>
<p>You&#8217;ll be asked where to save the key. Press Enter for the default (<code>~/.ssh/id_ed25519_sk</code> or <code>~/.ssh/id_ecdsa_sk</code>).</p>
<div class="ulist">
<ul>
<li>
<p>The private key file (<code>id_ed25519_sk</code>) generated for a FIDO2 key is small; it&#8217;s a handle or pointer to the key material on the YubiKey, not the actual private key.</p>
</li>
<li>
<p>The public key is saved in <code>id_ed25519_sk.pub</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>You&#8217;ll be asked for a passphrase for the key file.</p>
<div class="ulist">
<ul>
<li>
<p>For FIDO2 keys, especially resident ones requiring PIN and touch, this local file passphrase offers an additional layer of local protection for the <strong>key handle file</strong> but doesn&#8217;t encrypt the key material on the YubiKey itself. You can choose to set one or leave it empty.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Your public key (<code>~/.ssh/id_ed25519_sk.pub</code> or <code>~/.ssh/id_ecdsa_sk.pub</code>) is what you&#8217;ll provide to servers or services like GitHub.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-key-to-ssh-agent">.5. Adding Your FIDO2 SSH Key to the ssh-agent (Optional)</h3>
<div class="paragraph">
<p>The <code>ssh-agent</code> can cache your key&#8217;s details after the first use (including PIN if applicable for resident keys), so you don&#8217;t have to re-enter the PIN for subsequent connections in the same session. A physical touch on the YubiKey will still typically be required by the <code>-O verify-required</code> option or <code>credProtect</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure <code>ssh-agent</code> is running:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">eval "$(ssh-agent -s)"</code></pre>
</div>
</div>
</li>
<li>
<p>Add your SSH key file to the agent:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ssh-add ~/.ssh/id_ed25519_sk</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Replace with your key file name if different). You&#8217;ll be prompted for your FIDO2 PIN (if set and key is resident) and to touch your YubiKey.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="integrating-with-github">.6. Integrating with GitHub (and other services)</h3>
<div class="paragraph">
<p>To use your new FIDO2 SSH key with GitHub or other services that support SSH authentication:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Copy Your Public Key:</strong></p>
<div class="paragraph">
<p>Get the content of your <strong>public</strong> key file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># On Linux (requires xclip)
cat ~/.ssh/id_ed25519_sk.pub | xclip -selection clipboard

# On macOS
pbcopy &lt; ~/.ssh/id_ed25519_sk.pub

# On Windows (PowerShell)
Get-Content $env:USERPROFILE\.ssh\id_ed25519_sk.pub | Set-Clipboard</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, open the <code>.pub</code> file in a text editor and copy its content.</p>
</div>
</li>
<li>
<p><strong>Add the Public Key to GitHub:</strong></p>
<div class="ulist">
<ul>
<li>
<p>Log in to your GitHub account.</p>
</li>
<li>
<p>Go to Settings (click your profile picture in the top-right corner).</p>
</li>
<li>
<p>In the user settings sidebar, click "SSH and GPG keys."</p>
</li>
<li>
<p>Click "New SSH key" or "Add SSH key."</p>
</li>
<li>
<p>In the "Title" field, add a descriptive label (e.g., "My YubiKey 5C - ed25519-sk").</p>
</li>
<li>
<p>Paste your copied public key into the "Key" field.</p>
</li>
<li>
<p>Click "Add SSH key."</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Test the Connection:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ssh -T git@github.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see a message like:</p>
</div>
<div class="paragraph">
<p><code>Hi YourUsername! You&#8217;ve successfully authenticated, but GitHub does not provide shell access.</code>
You will be prompted to touch your YubiKey (and enter your FIDO2 PIN if required by the key/agent state).</p>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="conceptual_ssh_fido2_flow.png" alt="Conceptual SSH FIDO2 Flow">
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-resident-keys-new-machine">.7. Using Resident Keys on a New Machine</h3>
<div class="paragraph">
<p>If you generated a resident key (<code>-O resident</code>), its main advantage is portability. To use it on a new computer where you haven&#8217;t generated the key:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Ensure Prerequisites:</strong> The new machine must have a compatible OpenSSH client and your YubiKey drivers (usually handled by the OS).</p>
</li>
<li>
<p><strong>Retrieve Public Key Handles from YubiKey:</strong></p>
<div class="paragraph">
<p>Insert your YubiKey. Run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ssh-keygen -K</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will prompt for your FIDO2 PIN. It will then list any resident SSH key handles on the YubiKey and write their corresponding public key files (and empty private key handle files) to your <code>~/.ssh/</code> directory (e.g., <code>~/.ssh/id_ed25519_sk_rk.pub</code> and <code>~/.ssh/id_ed25519_sk_rk</code>).</p>
</div>
</li>
<li>
<p><strong>Use as Normal:</strong> You can now use this key with <code>ssh</code> or add it to your <code>ssh-agent</code> on the new machine. The private key handle file generated by <code>ssh-keygen -K</code> points to the key on your YubiKey.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="troubleshooting">.8. Troubleshooting</h3>
<div class="ulist">
<ul>
<li>
<p><strong>"Permission denied (publickey)" or No prompt for YubiKey:</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Verify Key on Server/Service:</strong> Ensure the correct public key (<code>.pub</code> file) has been added to the server&#8217;s <code>~/.ssh/authorized_keys</code> file or to your GitHub (or other service) account.</p>
</li>
<li>
<p><strong>SSH Verbose Mode:</strong> Use <code>ssh -vvv user@host</code> to get detailed debugging output. Look for lines related to key offerings and authentication methods.</p>
</li>
<li>
<p><strong>SSH Agent:</strong> If using <code>ssh-agent</code>, ensure the correct key has been added (<code>ssh-add -l</code>). Sometimes, other keys might be tried first. You can specify the key explicitly: <code>ssh -i ~/.ssh/your_fido_key user@host</code>.</p>
</li>
<li>
<p><strong>File Permissions:</strong> Ensure your <code>~/.ssh</code> directory has <code>700</code> permissions and your SSH key files (like <code>id_ed25519_sk</code>) have <code>600</code> permissions.</p>
</li>
<li>
<p><strong>YubiKey Not Detected:</strong> Ensure your YubiKey is properly inserted and recognized by the OS. Try re-inserting it. Check <code>lsusb</code> (Linux) or Device Manager (Windows).</p>
</li>
<li>
<p><strong>Correct Key Handle:</strong> If using <code>ssh-keygen -K</code>, ensure you are using the correct generated key handle file with your SSH commands or <code>ssh-add</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Problems with macOS Bundled OpenSSH:</strong></p>
<div class="paragraph">
<p>If you experience issues on macOS, it&#8217;s very likely due to the bundled OpenSSH version. Install the latest via Homebrew as described in <a href="#platform-specific-openssh">Platform-Specific OpenSSH Setup</a>.</p>
</div>
</li>
<li>
<p><strong>"Unsupported key type" or "Key enrollment failed: invalid format":</strong></p>
<div class="paragraph">
<p>Your OpenSSH client version might be too old. Verify it meets the prerequisites.</p>
</div>
</li>
<li>
<p><strong>PIN Prompts or Issues:</strong></p>
<div class="ulist">
<ul>
<li>
<p>If you set a FIDO2 PIN, it will be required for resident key operations.</p>
</li>
<li>
<p>If you forget your FIDO2 PIN, you&#8217;ll need to reset the FIDO2 application on your YubiKey using YubiKey Manager. <strong>This will delete all FIDO2 credentials (including any resident SSH keys and passkeys for websites) stored on the YubiKey.</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Identifying Keys on the YubiKey:</strong></p>
<div class="paragraph">
<p>If you have multiple resident keys, <code>ssh-keygen -K</code> will list them. The comment (<code>-C</code> value) you used during generation can help identify them if the filenames aren&#8217;t descriptive enough. The <code>-O application=ssh:&lt;name&gt;</code> option is also key here.</p>
</div>
</li>
<li>
<p><strong>GitHub-Specific Issues:</strong>
If you&#8217;re sure your SSH setup with the YubiKey is correct locally but GitHub connections fail, consult <a href="{https://docs.github.com/en/authentication/troubleshooting-ssh}">GitHub&#8217;s SSH troubleshooting documentation</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="security-considerations">.9. Important Security Considerations</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Physical Security of Your YubiKey:</strong> Your YubiKey <strong>is</strong> your key. Protect it physically. Consider a backup YubiKey configured with the same capabilities if access is critical.</p>
</li>
<li>
<p><strong>FIDO2 PIN Complexity:</strong> Choose a strong, unique PIN for your YubiKey&#8217;s FIDO2 application.</p>
</li>
<li>
<p><strong>SSH Agent Forwarding (<code>ssh -A</code>):</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Avoid SSH agent forwarding unless absolutely necessary and you fully understand the risks.</strong>* When agent forwarding is enabled, the ability to use your SSH keys (via the agent) is extended to the remote server. If that server is compromised, an attacker could potentially use your forwarded agent connection to authenticate to other systems as you. This can undermine some of the security benefits of a hardware-bound key, even though the private key itself doesn&#8217;t leave the YubiKey.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Workstation Security:</strong> While FIDO2 keys provide excellent protection, maintain good overall security hygiene on your workstations (updates, endpoint protection, etc.).</p>
</li>
<li>
<p><strong>Non-Resident Key Files:</strong> If you generate non-resident keys, the private key <strong>handle file</strong> (e.g., <code>~/.ssh/id_ed25519_sk</code>) on your disk is sensitive. Protect it with a strong file passphrase and appropriate file permissions, even though the actual private key material remains on the YubiKey. The <code>-O credProtect</code> option is crucial for non-resident keys.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="conclusion">.10. Conclusion</h3>
<div class="paragraph">
<p>Using your FIDO2 security key for SSH authentication significantly enhances your security posture by binding your SSH private keys to hardware and requiring user presence for operations. By following this guide, you can effectively set up and use YubiKeys for SSH with OpenSSH and integrate them into your development workflows with services like GitHub, providing a robust defense against common threats.</p>
</div>
<div class="paragraph">
<p>Always refer to the latest Yubico and OpenSSH documentation for the most up-to-date information and features.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-07-02 16:20:34 -0700
</div>
</div>
</body>
</html>